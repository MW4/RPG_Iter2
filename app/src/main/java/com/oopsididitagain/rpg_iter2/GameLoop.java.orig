package com.oopsididitagain.rpg_iter2;

import java.awt.Component;
<<<<<<< HEAD
import java.awt.event.KeyListener;
=======
>>>>>>> e4532fd536f3e1b3ce37775d67db469ed3b86452
import java.util.concurrent.TimeUnit;

import com.oopsididitagain.rpg_iter2.controllers.Controller;
import com.oopsididitagain.rpg_iter2.controllers.ExitGameController;
import com.oopsididitagain.rpg_iter2.controllers.menu_controllers.MainMenuController;
import com.oopsididitagain.rpg_iter2.model_view_interaction.ModelViewInteraction;
import com.oopsididitagain.rpg_iter2.utils.KeyBoardInput;
import com.oopsididitagain.rpg_iter2.views.View;

public class GameLoop {
	View view;
	KeyBoardInput keyboardInput;
	ModelViewInteraction modelViewInteraction;
	Controller controller;
	
	
	
	public GameLoop(){   //GameLoop constructor
	    
		
	
		controller = MainMenuController.getInstance();
		
	
		this.modelViewInteraction = controller.populateInteraction();
		keyboardInput =  controller.getKeyBoardInput();
		this.view = new View();
		view.addKeyListener( keyboardInput);
		view.addMouseListener(keyboardInput);
		
		view.setFocusable(true);
		view.requestFocusInWindow();
		
	}
	public void runGame() throws InterruptedException{   //Our main gameloop logic
		

		while(!controller.equals(ExitGameController.getInstance())){
			update();
			view.render(modelViewInteraction);
<<<<<<< HEAD
			TimeUnit.MILLISECONDS.sleep(18);
		}
	}
	public void update(){
		
		Controller temp = controller;
		
		controller = controller.takeInputAndUpdate(keyboardInput.getInput());
		

		if(!controller.equals(temp)){
			
			modelViewInteraction = controller.populateInteraction();
=======
			try {
				TimeUnit.MILLISECONDS.sleep(18);
			} catch(Exception ex) {
				ex.printStackTrace();
			}
			firstRun = false;
>>>>>>> e4532fd536f3e1b3ce37775d67db469ed3b86452
		}
		
		
	}

	public Component getView() {
		return view;
	}

}
